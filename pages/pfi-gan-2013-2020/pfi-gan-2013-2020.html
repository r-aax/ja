<!--
JA
-->

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta http-equiv="content-style-type" content="text/css">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <link rel="stylesheet" href="style.css" type="text/css" title="default" media="screen">
    <title>JA</title>
    <script type="text/javascript" language="JavaScript" src="../../js/ftree.js"></script>
    <script type="text/javascript" language="JavaScript" src="data.js"></script>
</head>

<script type="text/javascript" language="JavaScript">
<!--
// Построение дерева из данных результатов исследований.
function construct_ftree(data)
{
    var root = new Tree("root", "", "Корень");

    for (var sc_i = 0; sc_i < data.length; sc_i++)
    {
        var sc = data[sc_i];
        var sc_t = new Tree("science", "", sc.Str);

        root.AddChild(sc_t);

        for (var dr_i = 0; dr_i < sc.Sub.length; dr_i++)
        {
            var dr = sc.Sub[dr_i];
            var dr_t = new Tree("direction", "", dr.Str);

            sc_t.AddChild(dr_t);

            for (var ar_i = 0; ar_i < dr.Sub.length; ar_i++)
            {
                var ar = dr.Sub[ar_i];
                var ar_t = new Tree("area", "", ar.Str);

                dr_t.AddChild(ar_t);

                for (var rs_i = 0; rs_i < ar.Sub.length; rs_i++)
                {
                    var rs = ar.Sub[rs_i];
                    var rs_t = new Tree("result", "", rs.Str);

                    // Установка метки.
                    if (sc.Mark > 0)
                    {
                        rs_t.Mark = sc.Mark;
                    }
                    else if (dr.Mark > 0)
                    {
                        rs_t.Mark = dr.Mark;
                    }
                    else if (ar.Mark > 0)
                    {
                        rs_t.Mark = ar.Mark;
                    }
                    else
                    {
                        rs_t.Mark = rs.Mark;
                    }

                    ar_t.AddChild(rs_t);
                }
            }
        }
    }

    return root;
}

// Построение HTML по дереву.
function construct_results_table_HTML(t)
{
    var col_yes = "lightgreen";
    var col_maybe = "lightsteelblue";
    var col_no = "#EEEEEE";
    var s = "<center>" +
            " Цвета соответствия результатов суперкомпьютерным технологиям: " +
            "<font style=\"background-color : " + col_yes + "\">Да</font>" + ", " + 
            "<font style=\"background-color : " + col_maybe + "\">Возможно</font>" + ", " + 
            "<font style=\"background-color : " + col_no + "\">Нет</font>" +
            "</center>";
    var s = s + "<table width=\"100%\" border=\"0\" cellspacing=\"2\" cellpadding=\"2\" " +
            "   style=\"border-style : hidden; background-color : #DDDDDD\">";
    var total_res_counter = 1;
    var shown_res_counter = 1;

    for (var sc_i = 0; sc_i < t.ChildrenCount(); sc_i++)
    {
        var sc = t.Child(sc_i);
        var is_sc_show = true;

        for (var dr_i = 0; dr_i < sc.ChildrenCount(); dr_i++)
        {
            var dr = sc.Child(dr_i);
            var is_dr_show = true;

            for (var ar_i = 0; ar_i < dr.ChildrenCount(); ar_i++)
            {
                var ar = dr.Child(ar_i);
                var is_ar_show = true;

                for (var rs_i = 0; rs_i < ar.ChildrenCount(); rs_i++)
                {
                    var rs = ar.Child(rs_i);

                    sc_str = is_sc_show ? sc.Description : "&nbsp;";
                    dr_str = is_dr_show ? dr.Description : "&nbsp;";
                    ar_str = is_ar_show ? ar.Description : "&nbsp;";
                    rs_str = rs.Description;

                    var col_str = "";
                    switch (rs.Mark)
                    {
                        case 0:
                            // Не принято никакого решения по поводу результата.
                            col_str = "#FFFFFF";
                            break;

                        case 2:
                            // Результат подходит.
                            col_str = col_yes;
                            break;

                        case 4:
                            // Результат возможно подходит.
                            col_str = col_maybe;
                            break;

                        case 6:
                            // Результат не подходит.
                            col_str = col_no;
                            break;

                        case 8:
                            // Результат настолько не подходит, что не надо показывать.
                            col_str = "#EEEEEE";
                            break;

                        default:
                            alert("Error : unknown mark (and color).")
                            break;
                    }

                    //if ((rs.Mark == 2) || (rs.Mark == 4))
                    if (rs.Mark != 8)
                    {
                        s = s + 
                            "<tr>" +
                            "<td style=\"background-color : #FFFFFF\" valign=\"top\">" + sc_str + "</td>" +
                            "<td style=\"background-color : #FFFFFF\" valign=\"top\">" + dr_str + "</td>" +
                            "<td style=\"background-color : #FFFFFF\" valign=\"top\">" + ar_str + "</td>" +
                            "<td style=\"background-color : " + col_str + "; width : 100\%\" valign=\"top\">" +
                            rs_str + " [" + total_res_counter + "]" +
                            "</td>" + "</tr>";
                        shown_res_counter = shown_res_counter + 1;

                        // Сбрасываем названия науки, направления и области.
                        is_sc_show = false;
                        is_dr_show = false;
                        is_ar_show = false;
                    }

                    total_res_counter = total_res_counter + 1;
                }
            }
        }
    }

    s = s + "</table>";
    s = s + "<center>Показано результатов : " +
            (shown_res_counter - 1) + " из " +
            (total_res_counter - 1) + "</center>"

    return s;
}

// Загрузка контента.
function on_load()
{
    var t = construct_ftree(pfi_gan_2013_2020_data());
    var html = construct_results_table_HTML(t);

    document.getElementById("pfi_gan_div").innerHTML = html;
}
-->
</script>

<body onload="on_load()">

    <!-- Основная таблица. -->
    <table class="sketch">

        <!-- Таблица результов. -->
        <tr height="25px">
            <td class="dddddd" align="center">
                <font class="big-font">Таблица результатов по Программе фундаментальных научных
исследований государственных академий наук на 2013 - 2020 годы</font>
            </td>
        </tr>
        <tr>
            <td>
                <div id="pfi_gan_div"></div><br>
            </td>
        </tr>

        <!-- Футер. -->
        <tr><td class="dddddd"><img src="../../pics/pix.gif" height="20px"></td></tr>

    </table>

</body>

</html>
